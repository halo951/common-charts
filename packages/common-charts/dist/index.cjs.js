/** common-charts
 *
 * @author halo951(https://github.com/halo951)
 * @license MIT
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue"),t=require("echarts");const r={firstRenderSleep:0,clear:!1,renderer:(()=>{const e=navigator.userAgent.toLowerCase();return/mobile/.test(e)?"svg":"canvas"})()};const o=new class{pool=[];push(e){this.pool.push(e),this.execute()}lock=!1;execute(){if(!this.lock){for(;this.pool.length>0;)try{const e=this.pool.pop();requestAnimationFrame(e)}catch(e){console.error(e)}this.lock=!1}}},n=e.defineComponent({name:"Chart",props:{options:{type:Object,default:()=>({})},firstRenderSleep:{type:Number,default:()=>r.firstRenderSleep},clear:{type:Boolean,default:()=>r.clear},renderer:{type:String,default:()=>r.renderer}},setup(r,{}){const n=e.ref(null),s=e.ref(0),i=e.ref(),a=async()=>{var e;n.value&&(s.value>Date.now()&&await(e=s.value-Date.now(),new Promise((t=>setTimeout((()=>t()),e)))),o.push((()=>n.value?.setOption(r.options??{}))))},l=e=>{e.position||(e.confine=!0,e.position=function(e,t,r){if(r instanceof HTMLElement){if(r.getBoundingClientRect().left<0)return"right";if(r.getBoundingClientRect().right>window.innerWidth-r.clientWidth)return"left"}return"inside"})},p=()=>{n.value?.resize()};return e.watch(e.ref(r.options),(()=>(()=>{if(!n.value)return;r.clear&&n.value.clear();const{tooltip:e}=r.options;if(e)if(e instanceof Array)for(const t of e)l(t);else l(e);a()})())),e.onMounted((()=>{s.value=r.firstRenderSleep+Date.now(),n.value=t.init(i.value,"default",{renderer:r.renderer}),r.options&&a(),window.addEventListener("resize",p)})),e.onBeforeUnmount((()=>{n.value&&!n.value.isDisposed()&&(n.value.dispose(),window.removeEventListener("resize",p))})),{el:i}},render:()=>e.h("div",{ref:"el",class:"chart"})}),s=(e,t)=>{console.log("create bar")};exports.Chart=n,exports.createBar=s,exports.createPie=(e,t)=>{},exports.createSimpleBar=(e,t)=>{console.log("create simple bar"),s()},exports.createSimplePie=(e,t)=>{},exports.setClear=e=>{r.clear=e},exports.setFirstRenderSleep=e=>{r.firstRenderSleep=e},exports.setRenderer=e=>{r.renderer=e};
